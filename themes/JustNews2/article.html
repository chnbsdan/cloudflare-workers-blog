<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="renderer" content="webkit">
<meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width,viewport-fit=cover">
<title>{{ &articleSingle.title }} - {{ &OPT.siteName }}</title>
<meta name="keywords" content="{{ &keyWords }}" />
<meta name="description" content="{{ &OPT.siteDescription }}" />

<link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/gdtool/cloudflare-workers-blog@master/themes/JustNews/files/main.css' type='text/css' media='all' />
<link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/gdtool/cloudflare-workers-blog@master/themes/JustNews/files/font-awesome.css?ver=6.1.2' type='text/css' media='all' />
<link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/WordPress/WordPress@5.5.3/wp-includes/css/dist/block-library/style.min.css?ver=5.6' type='text/css' media='all' />
<link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/WordPress/WordPress@5.5.3/wp-includes/css/dist/components/style.min.css?ver=5.6' type='text/css' media='all' />
<link rel='stylesheet' href='https://fonts.geekzu.org/css?family=Noto+Serif%3A400%2C400i%2C700%2C700i&#038;ver=5.6' type='text/css' media='all' />
<link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/WordPress/WordPress@5.5.3/wp-includes/css/dist/block-editor/style.min.css?ver=5.6' type='text/css' media='all' />
<link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/WordPress/WordPress@5.5.3/wp-includes/css/dist/nux/style.min.css?ver=5.6' type='text/css' media='all' />
<link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/WordPress/WordPress@5.5.3/wp-includes/css/dist/editor/style.min.css?ver=5.6' type='text/css' media='all' />
<link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/newexsexy/wp@master/wp-content/plugins/ilab-media-tools/public/blocks/mediacloud-mux.blocks.style.min.css' type='text/css' media='all' />
<link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/emojify.js@1.1.0/dist/css/basic/emojify.min.css?ver=1.1.0' type='text/css' media='all' />
<script src='https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js'></script>
<script src='https://cdn.jsdelivr.net/gh/WordPress/WordPress@5.6/wp-includes/js/jquery/jquery-migrate.min.js'></script>
<script src='https://cdn.jsdelivr.net/gh/wpcom-cn/assets/fonts/icons-2.6.4.js'></script>
<link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.3.2/styles/tomorrow-night-bright.min.css">
<script src='https://cdn.staticfile.org/highlight.js/10.3.2/highlight.min.js'></script>

<!-- ÊñáÁ´†ÁõÆÂΩïÊ†∑Âºè -->
<style>
.sidebar {
    position: relative;
}

/* TOC Ê†∑Âºè */
#article-toc {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px;
    border: 1px solid #e1e1e1;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    z-index: 100;
    overflow-y: auto;
}

/* Ê°åÈù¢Á´ØÂõ∫ÂÆö TOC */
@media (min-width: 769px) {
    #article-toc {
        position: fixed;
        right: 20px;
        top: 100px;
        max-height: calc(100vh - 120px);
    }
}

/* ÁßªÂä®Á´ØÈÄÇÈÖç */
@media (max-width: 768px) {
    #article-toc {
        position: relative;
        top: 0;
        margin-bottom: 15px;
        max-height: 300px;
    }
}

#article-toc h3 {
    margin: 0 0 12px 0;
    padding-bottom: 8px;
    border-bottom: 2px solid #3b82f6;
    color: #2d3748;
    font-size: 16px;
    font-weight: 600;
    position: sticky;
    top: 0;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    z-index: 101;
    padding: 8px 0;
    margin-bottom: 8px;
}

#toc-list {
    list-style: none;
    padding: 0;
    margin: 0;
}
#toc-list::-webkit-scrollbar {
    width: 4px;
}
#toc-list::-webkit-scrollbar-thumb {
    background: #cbd5e0;
    border-radius: 2px;
}
#toc-list li { margin: 4px 0; line-height: 1.4; }
#toc-list a {
    display: block;
    padding: 6px 8px;
    color: #4a5568;
    text-decoration: none;
    border-radius: 4px;
    font-size: 14px;
    transition: all 0.2s ease;
    border-left: 3px solid transparent;
}
#toc-list a:hover {
    background: #f7fafc;
    color: #3b82f6;
    border-left-color: #3b82f6;
}
.toc-level-2 { padding-left: 12px; font-weight: 600; font-size: 14px; }
.toc-level-3 { padding-left: 24px; font-size: 13px; color: #4a5568; font-weight: 500; }
.toc-level-4 { padding-left: 36px; font-size: 12px; color: #718096; }
.toc-level-5 { padding-left: 48px; font-size: 12px; color: #a0aec0; }
.toc-level-6 { padding-left: 60px; font-size: 11px; color: #cbd5e0; }
.toc-active { background: #ebf8ff; color: #3b82f6; border-left-color: #3b82f6; font-weight: 500; }
.toc-empty { color: #a0aec0; font-style: italic; text-align: center; padding: 20px; }

/* ‰æßËæπÊ†èÂ∞èÈÉ®‰ª∂ */
.sidebar .widget {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px;
    border: 1px solid #e1e1e1;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    position: relative;
}
</style>

{{ &OPT.codeBeforHead }}
</head>
<body class="archive paged category category-zhishi category-5 paged-2 category-paged-2 lang-cn el-boxed">
<header class="header">
    <div class="container clearfix">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar icon-bar-1"></span>
                <span class="icon-bar icon-bar-2"></span>
                <span class="icon-bar icon-bar-3"></span>
            </button>
            <div class="logo">
                {{ #OPT.logo }}
                <a href="/" rel="home"><img src="{{ &OPT.logo }}" alt="{{ &OPT.siteName }}"></a>
                {{ /OPT.logo }}
                {{ ^OPT.logo }}
                <a href="/" rel="home"><img src="https://cdn.jsdelivr.net/gh/chnbsdan/cloudflare-workers-blog@master/themes/JustNews2/files/logo2.png" alt="ËØ∑Ëá™ÂÆö‰πâOPT.logo"></a>
                {{ /OPT.logo }}
            </div>
        </div>
        <div class="collapse navbar-collapse">
            <nav class="navbar-left primary-menu">
                <ul class="nav navbar-nav wpcom-adv-menu">
                    {{ #widgetMenuList }}
                        <li class="menu-item"><a href="{{ &url }}">{{ &title }}</a></li>
                    {{ /widgetMenuList }}
                </ul>
            </nav>
            <div class="navbar-action pull-right">
                <div id="j-user-wrap">
                    <a class="login cur" href="/admin">ÁôªÂΩï</a>
                </div>
            </div>
        </div>
    </div>
</header>

<div id="wrap">
    <div class="container wrap">
        <div class="main">
            <article id="post-{{ &articleSingle.id }}" class="post-{{ &articleSingle.id }} post type-post status-publish format-standard has-post-thumbnail hentry ">
                <div class="entry">
                    <div class="entry-head">
                        <h1 class="entry-title">{{ &articleSingle.title }}</h1>
                        <div class="entry-info">
                            <time class="entry-date published" datetime="{{ &articleSingle.createDate }}" pubdate="">{{ &articleSingle.createDate10 }}</time>
                            <span class="dot">‚Ä¢</span>
                            {{ #articleSingle.category }}
                                <a href="/category/{{&.}}" rel="category tag">{{&.}}</a>
                            {{ /articleSingle.category }}
                            <span class="dot">‚Ä¢</span>
                            <span class="leancloud_visitors">
                                <em>{{ &OPT.otherCodeA }}</em>
                                <span class="waline-pageview-count" data-path="{{ &articleSingle.url }}" />
                            </span>
                        </div>
                    </div>
                    <div class="entry-content">
                        {{ &articleSingle.contentHtml }}
                    </div>
                    <div class="entry-footer">
                        <div class="entry-tag">
                            {{ #articleSingle.tags }}
                                <a href="/tags/{{&.}}" rel="tag">{{&.}}</a>
                            {{ /articleSingle.tags }}
                        </div>

                        <div class="entry-page">
                            {{ #articleNewer }}    
                            <div class="entry-page-prev j-lazy lazyloaded" style="background-image: url(&quot;{{ &img }}&quot;); display: block;">
                                <a href="{{ &url }}" title="{{ &title }}" rel="prev" ><span>{{ &title }}</span></a>
                                <div class="entry-page-info">
                                    <span class="pull-left"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-arrow-left-double"></use></svg></i>‰∏ä‰∏ÄÁØá</span>
                                    <span class="pull-right">{{ &createDate10 }}</span>
                                </div>
                            </div>
                            {{ /articleNewer }}

                            {{ #articleOlder }}
                            <div class="entry-page-next j-lazy lazyloaded" style="background-image: url(&quot;{{ &img }}&quot;); display: block;">
                                <a href="{{ &url }}" title="{{ &title }}" rel="next" ><span>{{ &title }}</span></a>
                                <div class="entry-page-info">
                                    <span class="pull-right">‰∏ã‰∏ÄÁØá<i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-arrow-right-double"></use></svg></i></span>
                                    <span class="pull-left">{{ &createDate10 }}</span>
                                </div>
                            </div>
                            {{ /articleOlder }}
                        </div>
                    </div>
                    <div id="comments" class="entry-comments">
                        {{ &OPT.commentCode }}
                    </div>
                </div>
            </article>
        </div>

        <aside class="sidebar">
            <!-- ÊñáÁ´†ÁõÆÂΩï -->
            <div id="article-toc">
                <h3>üìë ÊñáÁ´†ÁõÆÂΩï</h3>
                <ul id="toc-list">
                    <li class="toc-empty">Ê≠£Âú®ÁîüÊàêÁõÆÂΩï...</li>
                </ul>
            </div>

            <!-- ÂÖ∂‰ªñÂ∞èÈÉ®‰ª∂‰øùÊåÅ‰∏çÂèò -->
            <div id="wpcom-post-thumb-2" class="widget widget_post_thumb">
                <h3 class="widget-title"><span>ËøëÊúüÊñáÁ´†</span></h3>
                <ul>
                    {{ #widgetRecentlyList }}
                    <li class="item">
                        <div class="item-img">
                            <a class="item-img-inner" href="{{ &url }}" title="{{ &title }}">
                                <img src="{{ &img }}" class="attachment-post-thumbnail wp-post-image j-lazy" /></a>
                        </div>
                        <div class="item-content">
                            <p class="item-title"><a href="{{ &url }}" title="{{ &title }}">{{&.}}</a></p>
                            <p class="item-date">{{ &createDate10 }}</p>
                        </div>
                    </li>
                    {{ /widgetRecentlyList }}
                </ul>
            </div>
            <div id="categories-3" class="widget widget_categories">
                <h3 class="widget-title"><span>ÂàÜÁ±ªÁõÆÂΩï</span></h3>
                <ul>
                    {{ #widgetCategoryList }}
                    <li class="cat-item"><a href="/category/{{&.}}">{{&.}}</a></li>
                    {{ /widgetCategoryList }}
                </ul>
            </div>
            <div id="tag_cloud-3" class="widget widget_tag_cloud">
                <h3 class="widget-title"><span>Ê†áÁ≠æ</span></h3>
                <div class="tagcloud">
                    {{ #widgetTagsList }}
                    <a href="/tags/{{&.}}" class="tag-cloud-link" style="font-size: 8pt;">{{&.}}</a>
                    {{ /widgetTagsList }}
                </div>
            </div>
            <div id="linkcat-0" class="widget widget_links">
                <h3 class="widget-title"><span>ÈìæÊé•</span></h3>
                <div class="link-tagcloud">
                    {{ #widgetLinkList }}
                        <a href="{{ &url }}" target="_blank" class="link-tag">{{ &title }}</a>
                    {{ /widgetLinkList }}
                </div>
            </div>
            
            {{ #OPT.widgetOther }}
            <div class="widget_other">{{ &OPT.widgetOther }}</div>
            {{ /OPT.widgetOther }}
        </aside>
    </div>
</div>

<!-- Á§æ‰∫§ÂõæÊ†áÊ†è -->
<div class="social-icons-bar">
    <a href="mailto:kekelove1688@gmail.com" class="social-icon" title="ÈÇÆÁÆ±"><i class="fas fa-envelope"></i></a>
    <a href="https://weibo.com/u/7866257468" class="social-icon" target="_blank" title="ÂæÆÂçö"><i class="fab fa-weibo"></i></a>
    <a href="https://www.facebook.com/profile.php?id=100091963634555" class="social-icon" target="_blank" title="Facebook"><i class="fab fa-facebook-f"></i></a>
    <a href="#" class="social-icon back-to-top" onclick="window.scrollTo({top:0,behavior:'smooth'});" title="ËøîÂõûÈ°∂ÈÉ®"><i class="fas fa-chevron-up"></i></a>
    <a href="https://x.com/home/@chnbsdan" class="social-icon" target="_blank" title="XÂ∏êÂè∑"><i class="fab fa-twitter"></i></a>
    <a href="https://space.bilibili.com/1913680621" class="social-icon" target="_blank" title="Bilibili"><i class="fab fa-bilibili"></i></a>
    <a href="https://t.me/ben_mesa" class="social-icon" target="_blank" title="Telegram"><i class="fab fa-telegram-plane"></i></a>
</div>

<footer class="footer">
    <div class="container">
        <div class="clearfix">
            <div class="footer-col footer-col-copy">
                <div class="copyright"><p>{{ &OPT.copyRight }}</p></div>
            </div>
            <div class="footer-col footer-col-sns"><div class="footer-sns"></div></div>
        </div>
    </div>
</footer>

<!-- ÊñáÁ´†ÁõÆÂΩïÁîüÊàêËÑöÊú¨ -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocList = document.getElementById('toc-list');
    const articleContent = document.querySelector('.entry-content');
    if (!tocList || !articleContent) return;

    // ÁîüÊàê TOC
    function generateTOC() {
        const headings = Array.from(articleContent.querySelectorAll('h1,h2,h3,h4,h5,h6'))
            .filter(h => h.textContent.trim() && !h.classList.contains('entry-title') && !h.closest('.widget') && !h.closest('.comments-area'));
        if (!headings.length) {
            tocList.innerHTML = '<li class="toc-empty">Êú¨ÊñáÊöÇÊó†ÊúâÊïàÁöÑÁõÆÂΩïÁªìÊûÑ</li>';
            return;
        }

        let html = '';
        headings.forEach((h,i)=>{
            let level = parseInt(h.tagName.substring(1));
            let id = h.id || ('toc-'+h.textContent.trim().toLowerCase().replace(/[^a-z0-9\u4e00-\u9fa5]/g,'-').replace(/-+/g,'-')+'-'+i);
            h.id = id;
            html += `<li class="toc-level-${level}"><a href="#${id}" data-level="${level}" title="${h.textContent.trim()}">${h.textContent.trim()}</a></li>`;
        });
        tocList.innerHTML = html;

        // ÁÇπÂáªÂπ≥ÊªëÊªöÂä®
        document.querySelectorAll('#toc-list a').forEach(a=>{
            a.addEventListener('click', e=>{
                e.preventDefault();
                const target = document.getElementById(a.getAttribute('href').slice(1));
                if (!target) return;
                window.scrollTo({top: target.getBoundingClientRect().top + window.scrollY - 80, behavior: 'smooth'});
            });
        });
    }

    generateTOC();

    // ÊªöÂä®È´ò‰∫Æ
    const tocLinks = Array.from(document.querySelectorAll('#toc-list a'));
    function highlightTOC() {
        let scrollPos = window.scrollY || document.documentElement.scrollTop;
        let activeSet = false;
        for (let i = headings.length-1; i >=0 ; i--) {
            let h = headings[i];
            if (scrollPos + 100 >= h.offsetTop) {
                tocLinks.forEach(a=>a.classList.remove('toc-active'));
                let activeLink = tocLinks.find(a=>a.getAttribute('href')==`#${h.id}`);
                if(activeLink) activeLink.classList.add('toc-active');
                activeSet = true;
                break;
            }
        }
        if(!activeSet) tocLinks.forEach(a=>a.classList.remove('toc-active'));
    }
    window.addEventListener('scroll', highlightTOC);
    highlightTOC();

    // TOC Âõ∫ÂÆöÂ∫ïÈÉ®ÊéßÂà∂
    function updateTOCPosition() {
        const toc = document.getElementById('article-toc');
        const main = document.querySelector('.main');
        if(!toc||!main) return;

        const mainTop = main.offsetTop;
        const mainBottom = mainTop + main.offsetHeight;
        const tocHeight = toc.offsetHeight;
        const scrollTop = window.scrollY || document.documentElement.scrollTop;
        let topOffset = 100;

        if(scrollTop + topOffset + tocHeight > mainBottom) {
            toc.style.top = (mainBottom - tocHeight - scrollTop) + 'px';
        } else {
            toc.style.top = topOffset + 'px';
        }
    }
    window.addEventListener('scroll', updateTOCPosition);
    window.addEventListener('resize', updateTOCPosition);
    updateTOCPosition();
});
</script>

</body>
</html>
